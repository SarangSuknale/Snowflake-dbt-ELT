
models:
  - name: int_stripe_customers
    description: >
                This intermediate model represents Stripe customers enriched with
                derived lifecycle metrics. Each record corresponds to a single Stripe
                customer and includes creation timing information to support customer
                tenure analysis, billing analytics, and user-to-customer linkage.

    tags:
      - stripe
      - customers
      - intermediate

    meta:
      owner: data_platform
      domain: billing
      source_system: stripe
      maturity: intermediate
      pii: true

    columns:
      - name: customer_id
        description: Unique identifier for the customer in Stripe.
        tests:
          - not_null
          - unique

      - name: created_date
        description: Timestamp when the Stripe customer was created.
        tests:
          - not_null

      - name: days_since_created
        description: Number of days since the Stripe customer was created.

      - name: months_since_created
        description: Number of months since the Stripe customer was created.

      - name: email
        description: Email address associated with the Stripe customer.
        meta:
          pii: true
          sensitivity: high

      - name: name
        description: Name associated with the Stripe customer.
        meta:
          pii: true

      - name: user_id
        description: Identifier of the internal user linked to the Stripe customer.
        tests:
          - relationships:
              arguments:
                to: ref('int_users')
                field: user_id
