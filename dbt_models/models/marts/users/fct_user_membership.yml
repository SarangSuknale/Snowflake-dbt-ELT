
models:
  - name: fct_user_membership
    description: >
      User-level membership dimension capturing membership plan, status,
      start and end dates, remaining duration, and boolean indicators for
      trial and paid membership status.

    meta:
      owner: analytics
      layer: mart
      grain: one row per user_id
      domain: users 
      tags: ['users', 'marts']
    
    tests:
      - date_order:
          arguments:
            start_column: membership_start
            end_column: membership_end
      - date_order:
          arguments:
            start_column: trial_start
            end_column: trial_end

    columns:
      - name: user_id
        description: Unique identifier of the user.
        tests:
          - not_null
          - unique

      - name: trial_start
        description: Start date of the user's trial membership.

      - name: trial_end
        description: End date of the user's trial membership.

      - name: membership_plan
        description: Name or type of the membership plan the user is enrolled in.

      - name: membership_status
        description: Current status of the membership (e.g., trial, active, cancelled).
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['trial', 'active', 'cancelled']
                quote: true

      - name: membership_start
        description: Start date of the current membership period.

      - name: membership_end
        description: End date of the current membership period.

      - name: membership_remaining_days
        description: Number of days remaining in the current membership period.

      - name: is_trial
        description: Indicates whether the user is currently on a trial membership.
        tests:
          - not_null
          - accepted_values:
              arguments:
                values:
                  - TRUE 
                  - FALSE
              

      - name: is_paid_users
        description: Indicates whether the user has an active paid membership.
        tests:
          - not_null
          - accepted_values:
              arguments:
                values:
                  - TRUE 
                  - FALSE
